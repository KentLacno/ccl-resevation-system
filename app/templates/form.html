{% extends "base.html" %}
{% block title %}Home Page{% endblock %}
{% block content %}
<div style="height: 90vh;" class="m-3 d-flex flex-lg-row">
  <div class="overflow-auto border p-3 w-25">
    <h1>Form #{{form.id}}</h1>

      {% if form.active %}
        {% if form.primary %}
          <span class="badge bg-success">Primary</span>
        {% endif %}
        <span class="badge bg-primary">Active</span>
      {% else %}
        <span class="badge bg-secondary">Inactive</span>
      {% endif %}

    <p class="mt-2"><b>Week:</b> {{form.week}}</p>
    <p style="word-wrap:break-word";><b>Form URL:</b> <a href="{{form.responder_uri}}">{{form.responder_uri}}</a></p>
    <br>
    {% for weekday in ["monday","tuesday","wednesday","thursday","friday"] %}
      <p><b>{{weekday.capitalize()}}:</b></p>
      {% for option in form.options %}
      <ul>
        {% if option.weekday == weekday %}
        <li>
          <span class="badge rounded-pill text-bg-secondary mb-0">{{option.food_item.name}} - ₱{{option.food_item.price}}</span>
        </li>
        {% endif %}
      </ul>
      {% endfor %}
    {% endfor %}
    {% if form.active %}
        {% if form.primary %}
          <form class="text-center mt-4" action="/set_primary_property/{{form.id}}" method="post">
            <button class="btn btn-secondary">Unset Primary</button>
          </form>
        {% else %}
          <form class="text-center mt-4" action="/set_primary_property/{{form.id}}" method="post">
            <button class="btn btn-success me-1">Set Primary</button>
          </form>
          <form class="text-center mt-2" action="/set_active_property/{{form.id}}" method="post">
            <button class="btn btn-secondary">Set Inactive</button>
          </form>
        {% endif %}
    {% else %}
      <form class="text-center mt-4" action="/set_active_property/{{form.id}}" method="post">
        <button class="btn btn-primary">Set Active</button>
      </form>
    {% endif %}
    <form class="text-center mt-2" action="/edit_form/{{form.id}}" method="post">
      <button class="btn btn-warning">Edit Form</button>
    </form>
  
  </div>
  <div class="border p-2 w-75 text-center">
    <button onclick="print()" class="m-4 btn btn-primary">Print Paid Reservations</button>
    <div class="m-4 mt-0 overflow-auto">
      <table id="order-table" class="table table-hover table-bordered">
        <thead class="table-light">
          <tr>
            <th style="width: 100px;" scope="col">Name</th>
            <th scope="col">Grade Section</th>
            <th scope="col">Paid</th>
            <th scope="col">Monday</th>
            <th scope="col">Tuesday</th>
            <th scope="col">Wednesday</th>
            <th scope="col">Thursday</th>
            <th scope="col">Friday</th>
          </tr>
        </thead>
        <tbody>
          {% for respondent in form.respondents %}
            <tr role="button" class="item" data-bs-toggle="modal" data-bs-target="#showRespondent">
              <th scope="row">{{respondent.name}}</th>
              <td>{{respondent.grade_section}}</td>
              <td>{{"Paid" if respondent.paid else "Pending"}}</td> 
              {% for weekday in ['monday','tuesday','wednesday','thursday','friday'] %}
                <td>
                  {% for reservation in respondent.reservations %}
                    {% if reservation.weekday == weekday %}
                    <span class="badge rounded-pill text-bg-secondary">{{reservation.food_item.name}} - ₱{{reservation.food_item.price}}  </span>
                    {% endif %}
                  {% endfor %}
                </td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<script type="text/javascript">
  function toggle(option) {
    var orderTable = document.getElementById("order-table");
    var weekTable = document.getElementById("week-table");
    if (option === "order") {
      orderTable.style.display = "";
      weekTable.style.display = "none";
    }
    else if (option === "week") {
      orderTable.style.display = "none";
      weekTable.style.display = "";
    }
  }
  function print() {
    window.location="{{ url_for('print_reservations.print', FormID=form.id) }}"
   
  } 
</script>
{% endblock %}
